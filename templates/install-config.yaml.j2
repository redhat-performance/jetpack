#jinja2: trim_blocks:True, lstrip_blocks:True
apiVersion: v1
baseDomain: "{{ ocp_base_domain }}"
clusterID: "{{ ocp_cluster_id }}"
compute:
- name: worker
  architecture: amd64
  hyperthreading: Enabled
  replicas: {{ worker_nodes }}
  {% if ocp_worker_flavor != "" %}
  platform:
    openstack:
      type: {{ ocp_worker_flavor }}
  {% else %}
  platform: {}
  {% endif %}
controlPlane:
  name: master
  architecture: amd64
  hyperthreading: Enabled
  replicas: {{ master_nodes }}
  {% if ocp_master_flavor != "" %}
  platform:
    openstack:
      type: {{ ocp_master_flavor }}
  {% else %}
  platform: {}
  {% endif %}
metadata:
  name: "{{ ocp_cluster_name }}"
networking:
  clusterNetworks:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  machineNetwork:
  - cidr: 10.196.0.0/16
  serviceNetwork:
  - 172.30.0.0/16
  type: "{{ ocp_network_type }}"
platform:
  openstack:
    cloud:             "{{ osp_project_name }}"
    externalNetwork:   "{{ public_net_name }}"
    region:            "regionOne"
    computeFlavor:     "{{ ocp_worker_flavor }}"
    lbFloatingIP:      "{{ api_floating_ip }}"
    ingressFloatingIP: "{{ ingress_floating_ip }}"
    externalDNS: ["{{ ansible_dns.nameservers| join('", "') }}"]
    octaviaSupport: "1"
    trunkSupport: "1"
publish: External
pullSecret: {{ ocp_pull_secret }}
sshKey: |
  {{ ssh_public_key }}
